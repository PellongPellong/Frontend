<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹¤ì‹œê°„ í˜¼ì¡ë„ íˆíŠ¸ë§µ - ì œì£¼</title>
    <link rel="stylesheet" href="./styles/main.css">
    
    <!-- 
        ì¤‘ìš”: XRayMap ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ê°€ì¥ ë¨¼ì € ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤!
        ë¡œì»¬ íŒŒì¼ì„ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.
    -->
    
    <!-- 1. XRayMap íˆíŠ¸ë§µ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ë¡œì»¬ íŒŒì¼) -->
    <!-- ì£¼ì˜: ì´ íŒŒì¼ì„ vendor/xraymap/ í´ë”ì— ë³µì‚¬í•´ì•¼ í•©ë‹ˆë‹¤! -->
    <script type="text/javascript" src="./vendor/xraymap/heatmap.js"></script>
    
    <!-- CDN ëŒ€ì•ˆ (ë¡œì»¬ íŒŒì¼ì´ ì—†ìœ¼ë©´ ì£¼ì„ í•´ì œ) -->
    <!-- <script type="text/javascript" src="https://www.policymap.or.kr/lib/xraymap/heatmap_20231212geonet.js"></script> -->
</head>
<body>
    <!-- í—¤ë” ì˜ì—­ -->
    <header class="header">
        <div class="header-content">
            <h1>ğŸ”¥ ì œì£¼ ì‹¤ì‹œê°„ í˜¼ì¡ë„ íˆíŠ¸ë§µ</h1>
            <div class="header-controls">
                <button id="refreshBtn" class="btn btn-primary">ìƒˆë¡œê³ ì¹¨</button>
                <button id="toggleLayerBtn" class="btn btn-secondary">ë ˆì´ì–´ í† ê¸€</button>
                <select id="locationSelect" class="select">
                    <option value="">-- ì§€ì—­ ì„ íƒ --</option>
                    <option value="jeju">ì œì£¼ì‹œ</option>
                    <option value="seogwipo">ì„œê·€í¬ì‹œ</option>
                </select>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <main class="main-container">
        <!-- ì‚¬ì´ë“œë°” (ë ˆì´ì–´ íŒ¨ë„) -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>ë ˆì´ì–´ ê´€ë¦¬</h2>
                <button id="closeSidebarBtn" class="close-btn">âœ•</button>
            </div>
            
            <div class="sidebar-content">
                <!-- ë ˆì´ì–´ ëª©ë¡ -->
                <div class="layer-section">
                    <h3>í™œì„± ë ˆì´ì–´</h3>
                    <div id="layerList" class="layer-list">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                    </div>
                </div>

                <!-- ë²”ë¡€ -->
                <div class="legend-section">
                    <h3>í˜¼ì¡ë„ ë²”ë¡€</h3>
                    <div class="legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background: #00FF00;"></span>
                            <span>ì—¬ìœ  (0-20%)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: #FFFF00;"></span>
                            <span>ë³´í†µ (20-50%)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: #FF8800;"></span>
                            <span>í˜¼ì¡ (50-80%)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: #FF0000;"></span>
                            <span>ê·¹í˜¼ì¡ (80-100%)</span>
                        </div>
                    </div>
                </div>

                <!-- ì‹¤ì‹œê°„ í†µê³„ -->
                <div class="stats-section">
                    <h3>ì‹¤ì‹œê°„ í†µê³„</h3>
                    <div id="statsContainer" class="stats">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                    </div>
                </div>
            </div>
        </aside>

        <!-- ì§€ë„ ì˜ì—­ -->
        <div class="map-wrapper">
            <div id="map" class="map-container"></div>
            
            <!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
            <div id="loadingIndicator" class="loading-indicator hidden">
                <div class="spinner"></div>
                <p>ë°ì´í„° ë¡œë”© ì¤‘...</p>
            </div>

            <!-- ì •ë³´ ì°½ -->
            <div id="infoWindow" class="info-window hidden">
                <div class="info-content">
                    <h4 id="infoTitle"></h4>
                    <div id="infoBody"></div>
                    <button class="close-btn">âœ•</button>
                </div>
            </div>
        </div>
    </main>

    <!-- 2. ë‚´ ìŠ¤í¬ë¦½íŠ¸ë“¤ -->
    <script src="./js/api-client.js"></script>
    <script src="./js/heatmap-engine.js"></script>
    <script src="./js/ui-manager.js"></script>
    <script src="./js/app.js"></script>
    
    <!-- ë””ë²„ê¹…: XRayMap ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ í™•ì¸ -->
    <script>
        console.log('ğŸ” XRayMap ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ìƒíƒœ:');
        console.log('  - HM_loadLayersByUrlFileAndRepalceTag:', typeof HM_loadLayersByUrlFileAndRepalceTag);
        console.log('  - HM_createPointFromDataString:', typeof HM_createPointFromDataString);
        
        if (typeof HM_loadLayersByUrlFileAndRepalceTag !== 'function') {
            console.error('âŒ XRayMap ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨!');
            console.log('ğŸ”§ í•´ê²° ë°©ë²•:');
            console.log('  1. ë¡œì»¬ì˜ data.ijto.or.kr/www.policymap.or.kr/lib_xraymap/ í´ë”ì—ì„œ');
            console.log('     heatmap ê´€ë ¨ .js íŒŒì¼ë“¤ì„');
            console.log('  2. heatmap-realtime/vendor/xraymap/ í´ë”ë¡œ ë³µì‚¬í•˜ì„¸ìš”.');
            console.log('  3. íŒŒì¼ëª…ì„ heatmap.jsë¡œ ë³€ê²½í•˜ê±°ë‚˜ index.htmlì˜ src ìˆ˜ì •');
            console.log('');
            console.log('ğŸ“ ì˜ˆì‹œ:');
            console.log('  cp data.ijto.or.kr/www.policymap.or.kr/lib_xraymap/heatmap_20231212geonet.js \\');
            console.log('     heatmap-realtime/vendor/xraymap/heatmap.js');
        } else {
            console.log('âœ… XRayMap ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì„±ê³µ!');
        }
    </script>
</body>
</html>
