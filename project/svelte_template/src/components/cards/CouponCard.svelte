<script>
    export let card;
    export let isCompact = true;

    const couponSources = [
        "Visitì œì£¼",
        "ì•¼ë†€ì",
        "í˜ì´ì½”",
        "ì¿ í°ë¶",
        "ì¸í„°íŒŒí¬",
        "ì—¬ê¸°ì–´ë•Œ",
    ];
    const randomSource =
        couponSources[Math.floor(Math.random() * couponSources.length)];
    
    // ë°±ë¡ì´ ë©”ì‹œì§€ ë°”ë¦¬ì—ì´ì…˜
    const couponMessages = [
        `<span class="font-bold">${randomSource}</span>ì—ì„œ ì¿ í°ì„ ì°¾ì•„ì™”ì–´ìš”! í• ì¸ ë°›ìœ¼ì„¸ìš” ğŸ«`,
        `íŠ¹ë³„í•œ í• ì¸ ì¿ í°ì„ ë°œê²¬í–ˆì–´ìš”! ê¿€íŒì´ì—ìš” ğŸ’›`,
        `ì €ë ´í•˜ê²Œ ì—¬í–‰í•˜ëŠ” ë¹„ê²°! ì¿ í° ì‚¬ìš©í•˜ì„¸ìš” ğŸ’°`,
        `<span class="font-bold">${randomSource}</span>ì— ì¢‹ì€ ì¿ í°ì´ ìˆë„¤ìš”! ì§€ê¸ˆ ë°”ë¡œ ì‚¬ìš©í•˜ì„¸ìš” âœ¨`,
        `í• ì¸ ì¿ í° ì°¾ì•˜ì–´ìš”! í•©ë¦¬ì ì¸ ì—¬í–‰ì„ ë„ì™€ë“œë¦´ê²Œìš” ğŸš€`
    ];
    
    const randomMessage = couponMessages[Math.floor(Math.random() * couponMessages.length)];
</script>

<!-- ë°±ë¡ì´ ëŒ€í™” -->
<div class="flex items-start gap-3 mb-4 bg-indigo-50 rounded-2xl p-4">
    <img
        src="/images/mascot.png"
        alt="ë°±ë¡ì´"
        class="w-10 h-10 flex-shrink-0 object-contain"
    />
    <div class="flex-1">
        <div class="text-sm text-indigo-900 leading-relaxed">
            {@html randomMessage}
        </div>
    </div>
</div>

<h3 class="text-2xl font-bold text-gray-900 mb-3">ì‚¬ìš© ê°€ëŠ¥ ì¿ í°</h3>

<div class="flex-1 overflow-hidden">
    {#if isCompact}
        <div class="space-y-2">
            {#each card.coupons.slice(0, 2) as coupon}
                <div
                    class="bg-purple-50 rounded-lg p-3 border border-purple-200"
                >
                    <div class="font-semibold text-gray-900 text-sm">
                        {coupon.name}
                    </div>
                    <div class="text-xs text-purple-600 font-mono">
                        {coupon.barcode}
                    </div>
                </div>
            {/each}
        </div>
    {:else}
        <div class="space-y-3">
            {#each card.coupons as coupon}
                <div
                    class="bg-purple-50 rounded-xl p-5 border border-purple-200 cursor-pointer hover:bg-purple-100 transition"
                >
                    <div class="font-bold text-gray-900 text-xl">
                        {coupon.name}
                    </div>
                    <div class="text-base text-purple-700 font-mono mt-2">
                        CODE: {coupon.barcode}
                    </div>
                    <div class="text-sm text-gray-500 mt-2">í´ë¦­í•˜ì—¬ ë³µì‚¬</div>
                </div>
            {/each}
        </div>
    {/if}
</div>